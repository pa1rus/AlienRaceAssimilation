<!DOCTYPE html>
<html lang="EN-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>Alien Race: Assimilation</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        background-color: rgb(0, 0, 0);
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
      }
      canvas.emscripten {
        background-color: black;
        display: block;
        height: 100%;
        width: auto;
        max-width: 100vw;
        max-height: 100vh;
      }
      #output {
        display: none;
      }
    </style>
    <script src="https://cdn.jsdelivr.net/gh/eligrey/FileSaver.js/dist/FileSaver.min.js"></script>
    <script>
      function saveFileFromMEMFSToDisk(memoryFSname, localFSname) {
        var data = FS.readFile(memoryFSname);
        var blob = new Blob([data.buffer], {
          type: "application/octet-stream",
        });
        saveAs(blob, localFSname);
      }
    </script>
  </head>
  <body>
    <canvas
      id="canvas"
      class="emscripten"
      oncontextmenu="event.preventDefault()"
      tabindex="-1"
    ></canvas>
    <p id="output"></p>

    <script>
      function resizeCanvas() {
        const canvas = document.getElementById("canvas");
        const winW = window.innerWidth;
        const winH = window.innerHeight;
        const targetRatio = 16 / 9;

        let newW, newH;

        if (winW / winH > targetRatio) {
          // okno jest "szersze" niż 16:9 → dopasuj do wysokości
          newH = winH;
          newW = newH * targetRatio;
        } else {
          // okno jest "wyższe" → dopasuj do szerokości
          newW = winW;
          newH = newW / targetRatio;
        }

        canvas.style.width = newW + "px";
        canvas.style.height = newH + "px";
      }

      window.addEventListener("resize", resizeCanvas);
      resizeCanvas();

      var Module = {
        canvas: document.getElementById("canvas"),
        print: (function () {
          var element = document.getElementById("output");
          return function (text) {
            console.log(text);
            if (element) {
              element.value += text + "\n";
              element.scrollTop = element.scrollHeight;
            }
          };
        })(),
      };
    </script>

    {{{ SCRIPT }}}
  </body>
</html>
